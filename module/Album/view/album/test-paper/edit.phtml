<h3>试卷编辑</h3></br>
<h4><?php 
$testPaper = $this->TestPaper;
$Questions = $this->Questions;
$form = $this->form;
$form2 = $this->form2;
echo"学年: &nbsp".$testPaper->year."&nbsp&nbsp";
echo"学期:".$testPaper->termNum."&nbsp&nbsp";
echo "单元:".$testPaper->unitNum;
?>

<a href="#">点我啊</a>


<a href="<?php echo $this->url('TestPaper',array('action'=>'index'));?>">返回主页</a></h3>
</h4>  
<table class = "table">
   <tr class="testpapertr"> 
<th>题号</th>
<th>所属类型/知识点</th>
<th>难度</th>
<th>备注</th>
<th>保存</th>
</tr>

<?php
$form->prepare();
$form->setAttribute('action',$this->url(Null,array('controller'=>'TestPaper','action'=>'editprocess')));
$form->setAttribute('method','post');
echo $this->form()->openTag($form);

$a = $testPaper->questionType;
$b = explode(',', $a); // 分离出题目的格式“题型：起始数-终止数，题型：起始数-终止数”

$count = count($b); // 计算题型总数
for ($i = 0; $i < $count - 1; $i ++) { // 这里要减1，
    list ($type, $num) = explode(":", $b[$i]); // 分离出“题型和起始数-终止数”
    list ($start, $end) = explode("-", $num); // 分离出“起始数和终止数”
    for ($qstart = $start; $qstart <= $end; $qstart ++) {
        
        echo "<tr class = 'questionTr-" . $i . "'  >" ;
        echo "<td width = '5%'>".$Questions[$qstart - 1]['questionNum'];
        echo $this->formelement($form->get('id')->setAttribute('value',$Questions[$qstart - 1]['id']));
        echo $this->formelement($form->get('tid')->setAttribute('value',$Questions[$qstart - 1]['tid']));
        echo $this->formelement($form->get('questionNum[]')->setAttribute('value',$Questions[$qstart - 1]['questionNum']))."</td>";
        
        echo "<td class='showType' width = '15%'>";
       echo $this->formelement($form->get('grammaType[]')->setAttribute('value',$Questions[$qstart - 1]['grammaType']))."</td>";
        
        echo "<td width = '25%'>";
        echo "<ul class = 'rating nonstar'>
      <li class= 'star'><a href='#' title=1;>☆</a></li>
      <li class= 'star'><a href='#' title=2;>☆</a></li>
      <li class= 'star'><a href='#' title=3;>☆</a></li>
      <li class= 'star'><a href='#' title=4;>☆</a></li>
      <li class= 'star'><a href='#' title=5;>☆</a></li>
            </ul>";
        echo"</td>";
        echo "<td width = '40%'>";
        echo $this->formelement($form->get('content[]')->setAttribute('value',$Questions[$qstart - 1]['content']));
        echo $this->formElementErrors($form->get('content[]'))."</td>";
       //★☆ 
     
      
        
        echo "<td width = '10%'>";
        echo $this->formelement($form->get('submit')->setAttribute('value','保存'))."</td></tr>";

        echo "<tr class = subTr><td class = 'afterTrTd' colspan=5>";?>
        <div class = "afterTrDiv">
            <div class="grammarTypeDiv">
                        <?php
                        echo $this->formlabel($form2->get('grammarType'));
                        echo $this->formelement($form2->get('grammarType'));
                        echo $this->formelementerrors($form2->get('grammarType'));
                        ?>
            </div>              
            <div class="grammarTypeDiv">
                        <?php
                        echo $this->formlabel($form2->get('grammarType2'));
                        echo $this->formelement($form2->get('grammarType2'));
                        echo $this->formelementerrors($form2->get('grammarType2'));
                        ?>
            </div>              
            <div class="grammarTypeDiv">
                        <?php
                        echo $this->formlabel($form2->get('grammarType3'));
                        echo $this->formelement($form2->get('grammarType3'));
                        echo $this->formelementerrors($form2->get('grammarType3'));
                        ?>
            </div>              
        </div>      
        
        <?php echo "</td></tr>";
        echo $this->form()->closeTag();
    }
}
?>



</table>